RV_PREFIX := riscv64-unknown-linux-gnu-
RV_GCC := $(RV_PREFIX)gcc
RV_AS := $(RV_PREFIX)as
RV_FLAGS := -mabi=ilp32 -march=rv32i_zicsr
RV_OBJDUMP := $(RV_PREFIX)objdump
RV_FLAGS_OBJ := -S --no-addresses -M no-aliases -M numeric

traphandler.asm: traphandler.c
		$(RV_GCC) $(RV_FLAGS) traphandler.c -o traphandler.asm -S

traphandler.o: traphandler.c
		$(RV_GCC) $(RV_FLAGS) traphandler.c -o traphandler.o -S

traphandler.elf: traphandler.o
		$(RV_AS) $(RV_FLAGS) traphandler.o -o traphandler.elf

traphandler.bin: traphandler.c
		$(RV_GCC) -o traphandler.bin traphandler.c 


.PHONY:clean

clean:
		rm  *.o *.elf *.hex *.asm

traphandler.hex: traphandler.elf
		eval $(RV_OBJDUMP) traphandler.elf $(RV_FLAGS_OBJ) >> traphandler.hex